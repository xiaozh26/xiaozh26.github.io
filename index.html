<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xiao Zhang's Personal Website</title>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XSNCG33J0H"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-XSNCG33J0H');
    </script>
    
    <link rel="shortcut icon" type="image/x-icon" href="cal.jpg">

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Three.js for 3D Simulation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');
        
        :root {
            --font-main: 'Inter', sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
        }

        body {
            font-family: var(--font-main);
            background-color: #020617; /* Darkest Slate Background */
            color: #f1f5f9; /* Light Slate text */
        }

        .mono { font-family: var(--font-mono); }

        .glass-card {
            background: rgba(15, 23, 42, 0.6); 
            backdrop-filter: blur(12px);
            border: 1px solid rgba(51, 65, 85, 0.5); 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-card:hover {
            transform: translateY(-4px);
            border-color: #3b82f6;
            background: rgba(30, 41, 59, 0.8);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
        }

        .sidebar-fixed {
            position: sticky;
            top: 2rem;
            height: calc(100vh - 4rem);
        }

        .view-section {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .view-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .skill-tag {
            font-size: 0.75rem;
            padding: 0.125rem 0.6rem;
            border-radius: 4px;
            background: #1e293b;
            color: #94a3b8;
            border: 1px solid #334155;
            font-family: var(--font-mono);
        }

        /* Custom Scrollbar for Dark Mode */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #020617; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #475569; }

        /* Custom Tooltip Styles */
        .tooltip-content {
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform: translateY(10px);
        }
        .group:hover .tooltip-content {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }

        #vessel-canvas-container canvas {
            border-radius: 1rem;
            cursor: crosshair;
        }
        
        /* Thermal Demo Animations */
        @keyframes flow {
            0% { stroke-dashoffset: 20; }
            100% { stroke-dashoffset: 0; }
        }
        .pipe-flow { stroke-dasharray: 6; animation: flow 1s linear infinite; }
        .hidden-flow { opacity: 0.1; animation: none; }
    </style>
</head>
<body class="antialiased">

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-12">
        <div class="flex flex-col lg:flex-row gap-12">
            
            <!-- LEFT COLUMN: Identity & Bio -->
            <aside class="w-full lg:w-1/3">
                <div class="sidebar-fixed flex flex-col justify-between">
                    <div>
                        <div class="group relative w-32 h-32 rounded-2xl bg-slate-800 mb-8 overflow-hidden border-2 border-slate-700 shadow-xl cursor-pointer">
                            <img src="pfp2.png" alt="Profile" class="absolute inset-0 w-full h-full object-cover transition-opacity duration-500 ease-in-out group-hover:opacity-0">
                            <img src="pfp1.jpg" alt="Profile Hover" class="absolute inset-0 w-full h-full object-cover opacity-0 transition-opacity duration-500 ease-in-out group-hover:opacity-100">
                            <div class="absolute inset-0 -z-10 flex items-center justify-center text-slate-600">
                                <i data-lucide="user" class="w-12 h-12"></i>
                            </div>
                        </div>

                        <h1 class="text-3xl font-bold tracking-tight text-slate-50 mb-2">Xiao Zhang</h1>
                        <p class="text-blue-400 font-medium mb-6 mono text-sm tracking-wide uppercase">EECS and Economics @ UC Berkeley</p>
                        
                        <div class="space-y-4 text-slate-400 leading-relaxed max-w-sm mb-8">
                            <p>I'm an 18-year-old EECS and Economics undergraduate at UC Berkeley, passionate about robotics and fascinated by the intersection of perception and autonomy.</p>
                            <p>I'm eager to explore how intelligent systems can perceive, learn, and act in the world, and to contribute to advancing autonomous technologies.</p>
                        </div>

                        <div class="mb-10">
                            <div class="flex items-center gap-2 mb-4 border-b border-slate-800 pb-2">
                                <i data-lucide="award" class="w-4 h-4 text-amber-500"></i>
                                <span class="text-xs font-bold text-slate-400 uppercase tracking-widest">Professional Affiliations</span>
                            </div>
                            
                            <div class="flex flex-col gap-3">
                                <!-- Tau Beta Pi (Bigger & Bolder) -->
                                <div class="group relative flex items-center gap-4 p-4 rounded-xl bg-slate-900 border border-slate-700 hover:border-amber-500/50 hover:bg-slate-800 transition-all cursor-help shadow-lg">
                                    <div class="w-12 h-12 rounded-lg bg-white p-1.5 shadow-inner flex-shrink-0">
                                        <img src="tbp.png" alt="Tau Beta Pi" class="w-full h-full object-contain">
                                    </div>
                                    <div class="flex flex-col">
                                        <span class="text-sm font-bold text-slate-100 leading-tight group-hover:text-amber-400 transition-colors">Tau Beta Pi</span>
                                        <span class="text-[10px] text-slate-500 font-mono uppercase tracking-wider mt-1">Engineering Honor Society</span>
                                    </div>
                                    <!-- Tooltip -->
                                    <div class="tooltip-content absolute bottom-full left-0 mb-3 w-72 p-4 rounded-xl bg-slate-900/95 border border-amber-500/30 backdrop-blur-md shadow-2xl z-50 pointer-events-none text-left">
                                        <p class="text-xs leading-relaxed text-slate-300">
                                            <span class="text-amber-400 font-bold block mb-1">Tau Beta Pi (CA Alpha)</span>
                                            The oldest engineering honor society. Inducted 2025; representing the top 12.5% of the junior standing engineering class at UC Berkeley.
                                        </p>
                                        <div class="absolute top-full left-8 w-3 h-3 bg-slate-900 border-r border-b border-amber-500/30 transform rotate-45 -translate-y-1.5"></div>
                                    </div>
                                </div>

                                <!-- IEEE-HKN (Bigger & Bolder) -->
                                <div class="group relative flex items-center gap-4 p-4 rounded-xl bg-slate-900 border border-slate-700 hover:border-amber-500/50 hover:bg-slate-800 transition-all cursor-help shadow-lg">
                                    <div class="w-12 h-12 rounded-lg bg-white p-1.5 shadow-inner flex-shrink-0">
                                        <img src="hkn.png" alt="IEEE-HKN" class="w-full h-full object-contain">
                                    </div>
                                    <div class="flex flex-col">
                                        <span class="text-sm font-bold text-slate-100 leading-tight group-hover:text-amber-400 transition-colors">Eta Kappa Nu</span>
                                        <span class="text-[10px] text-slate-500 font-mono uppercase tracking-wider mt-1">Electrical & Computer Engineering Honor Society</span>
                                    </div>
                                    <!-- Tooltip -->
                                    <div class="tooltip-content absolute bottom-full left-0 mb-3 w-72 p-4 rounded-xl bg-slate-900/95 border border-amber-500/30 backdrop-blur-md shadow-2xl z-50 pointer-events-none text-left">
                                        <p class="text-xs leading-relaxed text-slate-300">
                                            <span class="text-amber-400 font-bold block mb-1">Eta Kappa Nu (Mu Chapter)</span>
                                            The honor society of Electrical & Computer Engineering. Inducted 2025; selected for outstanding academic achievement, leadership and character in EECS at UC Berkeley.
                                        </p>
                                        <div class="absolute top-full left-8 w-3 h-3 bg-slate-900 border-r border-b border-amber-500/30 transform rotate-45 -translate-y-1.5"></div>
                                    </div>
                                </div>

                                <!-- IEEE Membership -->
                                <div class="group relative flex items-center gap-4 p-4 rounded-xl bg-slate-900 border border-slate-700 hover:border-amber-400/50 hover:bg-slate-800 transition-all cursor-help shadow-lg">
                                    <div class="w-12 h-12 rounded-lg bg-white p-1.5 shadow-inner flex-shrink-0">
                                        <img src="ieee.png" alt="IEEE" class="w-full h-full object-contain">
                                    </div>
                                    <div class="flex flex-col">
                                        <span class="text-sm font-bold text-slate-100 leading-tight group-hover:text-amber-400 transition-colors">IEEE</span>
                                        <span class="text-[10px] text-slate-500 font-mono uppercase tracking-wider mt-1">Institute of Electrical and Electronics Engineers</span>
                                    </div>
                                    <!-- Tooltip -->
                                    <div class="tooltip-content absolute bottom-full left-0 mb-3 w-72 p-4 rounded-xl bg-slate-900/95 border border-amber-400/30 backdrop-blur-md shadow-2xl z-50 pointer-events-none text-left">
                                        <p class="text-xs leading-relaxed text-slate-300">
                                            <span class="text-amber-400 font-bold block mb-1">IEEE (Student Member)</span>
                                            The world's largest technical professional organization dedicated to advancing technology for the benefit of humanity. Active student member.
                                        </p>
                                        <div class="absolute top-full left-8 w-3 h-3 bg-slate-900 border-r border-b border-amber-400/30 transform rotate-45 -translate-y-1.5"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="flex gap-4">
                            <a href="https://linkedin.com/in/xiaozhang07" target="_blank" class="p-2 text-slate-500 hover:text-blue-400 transition-colors" title="LinkedIn"><i data-lucide="linkedin"></i></a>
                            <a href="https://github.com/xiaozh26" target="_blank" class="p-2 text-slate-500 hover:text-slate-100 transition-colors" title="GitHub"><i data-lucide="github"></i></a>
                            <a href="javascript:void(0)" 
                            onclick="window.location.href='mailto:' + atob('eGlhb196aGFuZ0BiZXJrZWxleS5lZHU=')" 
                            class="p-2 text-slate-500 hover:text-orange-400 transition-colors" 
                            title="Email">
                                <i data-lucide="mail"></i>
                            </a>
                        </div>
                    </div>

                    <div class="mt-12">
                        <button onclick="showSection('home')" class="flex items-center gap-2 text-sm font-semibold text-slate-500 hover:text-blue-400 transition-colors">
                            <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to Overview
                        </button>
                    </div>
                </div>
            </aside>

            <!-- RIGHT COLUMN: Main Content -->
            <main class="w-full lg:w-2/3">
                
                <!-- HOME VIEW -->
                <section id="home" class="view-section active">
                    <h2 class="text-sm font-bold uppercase tracking-widest text-slate-500 mb-8">Technical Overview</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div onclick="showSection('experience')" class="glass-card p-8 rounded-2xl cursor-pointer group">
                            <div class="w-12 h-12 rounded-xl bg-blue-500/10 text-blue-400 flex items-center justify-center mb-6 group-hover:bg-blue-600 group-hover:text-white transition-all"><i data-lucide="briefcase"></i></div>
                            <h3 class="text-xl font-bold mb-2 text-slate-100">Work Experience</h3>
                            <p class="text-slate-400 text-sm">Professional leadership and industry roles.</p>
                        </div>
                        <div onclick="showSection('research')" class="glass-card p-8 rounded-2xl cursor-pointer group">
                            <div class="w-12 h-12 rounded-xl bg-purple-500/10 text-purple-400 flex items-center justify-center mb-6 group-hover:bg-purple-600 group-hover:text-white transition-all"><i data-lucide="microscope"></i></div>
                            <h3 class="text-xl font-bold mb-2 text-slate-100">Research</h3>
                            <p class="text-slate-400 text-sm">Undergraduate research positions and lab collaborations at Berkeley.</p>
                        </div>
                        <div onclick="showSection('projects')" class="glass-card p-8 rounded-2xl cursor-pointer group">
                            <div class="w-12 h-12 rounded-xl bg-emerald-500/10 text-emerald-400 flex items-center justify-center mb-6 group-hover:bg-emerald-600 group-hover:text-white transition-all"><i data-lucide="cpu"></i></div>
                            <h3 class="text-xl font-bold mb-2 text-slate-100">Technical Projects</h3>
                            <p class="text-slate-400 text-sm">Academic engineering builds and system designs.</p>
                        </div>
                        <div onclick="showSection('coursework')" class="glass-card p-8 rounded-2xl cursor-pointer group">
                            <div class="w-12 h-12 rounded-xl bg-orange-500/10 text-orange-400 flex items-center justify-center mb-6 group-hover:bg-orange-600 group-hover:text-white transition-all"><i data-lucide="book-open"></i></div>
                            <h3 class="text-xl font-bold mb-2 text-slate-100">Relevant Coursework</h3>
                            <p class="text-slate-400 text-sm">Academic record and progress in EECS and Economics.</p>
                        </div>
                    </div>
                </section>

                <!-- WORK EXPERIENCE VIEW -->
                <section id="experience" class="view-section">
                    <h2 class="text-2xl font-bold text-slate-100 mb-8">Work Experience</h2>
                    <div id="experience-container" class="space-y-6">
                        <!-- Content injected via JS -->
                    </div>
                </section>

                <!-- RESEARCH VIEW -->
                <section id="research" class="view-section">
                    <h2 class="text-2xl font-bold text-slate-100 mb-8">Research</h2>
                    <div id="research-container" class="space-y-8">
                        <!-- Content injected via JS -->
                    </div>
                </section>

                <!-- PROJECTS VIEW -->
                <section id="projects" class="view-section">
                    <h2 class="text-2xl font-bold text-slate-100 mb-8">Technical Projects</h2>
                    <div class="grid grid-cols-1 gap-12">
                        
                         <!-- PROJECT: ROS 2 -->
                         <div class="glass-card rounded-2xl overflow-hidden flex flex-col">
                            <div class="w-full bg-slate-900 relative h-[400px] border-b border-slate-800 group">
                                <!-- Video Demo -->
                                <video autoplay loop muted playsinline class="w-full h-full object-cover opacity-90 group-hover:opacity-100 transition-opacity">
                                    <source src="ra6df.mp4" type="video/mp4">
                                </video>
                                
                                <!-- Overlay Gradient -->
                                <div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent opacity-60"></div>

                                <!-- Floating Badge -->
                                <div class="absolute bottom-6 left-6">
                                    <div class="flex items-center gap-2">
                                        <div class="p-2 bg-slate-900/90 rounded-lg border border-slate-700 text-purple-400">
                                            <i data-lucide="bot" class="w-6 h-6"></i>
                                        </div>
                                        <div class="px-3 py-1.5 bg-purple-500/20 backdrop-blur-md rounded-lg border border-purple-500/30">
                                            <span class="text-xs font-bold text-purple-300 tracking-wide">ROS 2 HUMBLE</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="w-full p-8 flex flex-col justify-between">
                                <div>
                                    <h3 class="text-xl font-bold text-slate-100 mb-2">Simulation and Control of a 6-DOF Robotic Arm for Autonomous Manipulation</h3>
                                    <p class="text-slate-400 text-sm mb-6 leading-relaxed">
                                        In this project, I built ROS 2 packages to simulate and control a 6-degree-of-freedom robotic arm using ROS 2 Control and MoveIt 2. The system integrates Gazebo for physics-based simulation and RViz for visualization, and includes an RGB-D depth camera that produces simulated 3D point clouds for perception and vision experiments. Using this setup, I successfully implemented grasp-and-place manipulation in simulation.
                                    </p>
                                    <div class="flex flex-wrap gap-2">
                                        <span class="skill-tag">ROS 2 Humble</span>
                                        <span class="skill-tag">ROS 2 Control</span>
                                        <span class="skill-tag">MoveIt 2</span>
                                        <span class="skill-tag">Gazebo</span>
                                        <span class="skill-tag">RViz</span>
                                        <span class="skill-tag">RGBD Point Cloud</span>
                                        <span class="skill-tag">Robotics</span>
                                    </div>
                                </div>
                                <div class="pt-6 border-t border-slate-800 mt-6">
                                    <a href="#" class="block w-full text-center py-3 bg-slate-100 hover:bg-white text-slate-900 rounded-xl font-bold text-xs transition-all flex items-center justify-center gap-2">
                                        <i data-lucide="github" class="w-4 h-4"></i> ACCESS REPOSITORY
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- FLAGSHIP PROJECT: AUTONOMOUS RESEARCH VESSEL (Vertical Layout) -->
                        <div class="glass-card rounded-2xl overflow-hidden flex flex-col">
                            <div class="w-full bg-[#020617] relative min-h-[500px] border-b border-slate-800" id="vessel-canvas-container">
                                <!-- Telemetry HUD -->
                                <div class="absolute top-6 left-6 z-10 space-y-4 pointer-events-none">
                                    <div class="glass-card bg-slate-900/90 border-slate-700/50 p-4 rounded-xl w-48 shadow-2xl">
                                        <p class="text-[10px] mono text-slate-500 uppercase tracking-widest mb-2 flex items-center gap-2">
                                            <span class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></span> Pose Telemetry
                                        </p>
                                        <div class="space-y-1.5 mono text-xs">
                                            <p class="flex justify-between"><span class="text-slate-500">X:</span> <span id="tel-x" class="text-blue-400">0.00</span></p>
                                            <p class="flex justify-between"><span class="text-slate-500">Y:</span> <span id="tel-y" class="text-blue-400">0.00</span></p>
                                            <p class="flex justify-between"><span class="text-slate-500">θ:</span> <span id="tel-th" class="text-blue-400">0.00°</span></p>
                                            <p class="flex justify-between border-t border-slate-800 pt-1 mt-1"><span class="text-slate-500">STATUS:</span> <span id="tel-stat" class="text-emerald-400">IDLE</span></p>
                                        </div>
                                    </div>
                                    <div class="glass-card bg-slate-900/90 border-slate-700/50 p-4 rounded-xl w-48">
                                        <p class="text-[10px] mono text-slate-500 uppercase tracking-widest mb-2">Distance Sensors (mm)</p>
                                        <div class="grid grid-cols-2 gap-2 mono text-[10px]">
                                            <div class="p-1.5 bg-slate-950 rounded border border-slate-800 text-center"><span class="block text-slate-600">Front</span><span id="s1-val">---</span></div>
                                            <div class="p-1.5 bg-slate-950 rounded border border-slate-800 text-center"><span class="block text-slate-600">Right</span><span id="s2-val">---</span></div>
                                            <div class="p-1.5 bg-slate-950 rounded border border-slate-800 text-center"><span class="block text-slate-600">Back</span><span id="s3-val">---</span></div>
                                            <div class="p-1.5 bg-slate-950 rounded border border-slate-800 text-center"><span class="block text-slate-600">Left</span><span id="s4-val">---</span></div>
                                        </div>
                                    </div>
                                    <div class="px-2 py-1 bg-blue-500/10 rounded border border-blue-500/20">
                                        <p class="text-[9px] mono text-blue-400">INFO: Click water to set mission point</p>
                                    </div>
                                </div>

                                <!-- Interaction Overlay -->
                                <div class="absolute bottom-6 right-6 z-10 flex gap-3 pointer-events-auto">
                                    <button onclick="triggerRTH()" id="rth-btn" class="px-6 py-2 bg-orange-600/20 border border-orange-500/50 hover:bg-orange-600 hover:text-white rounded-lg text-xs font-bold text-orange-400 transition-all flex items-center gap-2">
                                        <i data-lucide="home" class="w-3 h-3"></i> RTH
                                    </button>
                                </div>
                            </div>

                            <!-- Content Section -->
                            <div class="p-10">
                                <div class="flex flex-col lg:flex-row gap-10">
                                    <div class="lg:w-2/3">
                                        <div class="flex items-center gap-3 mb-4">
                                            <span class="p-2 rounded-xl bg-blue-500/10 text-blue-400"><i data-lucide="navigation-2"></i></span>
                                            <h3 class="text-2xl font-bold text-slate-50">Autonomous Research Vessel Navigation Stack</h3>
                                        </div>
                                        <p class="text-slate-400 leading-relaxed mb-6">
                                            Engineered the localization and navigation stack for an autonomous waterfowl research vessel used in ecological field studies. Designed and integrated hardware systems for precise GPS/IMU positioning and ultrasonic ranging. Developed custom navigation algorithms including A* algorithm, vector field histograms for real-time obstacle avoidance and a Return-to-Home (RTH) sequence.
                                        </p>
                                        <div class="flex flex-wrap gap-2">
                                            <span class="skill-tag">Localization Stack</span>
                                            <span class="skill-tag">Obstacle Avoidance</span>
                                            <span class="skill-tag">VFH Algorithm</span>
                                            <span class="skill-tag">Fail-safe RTH</span>
                                            <span class="skill-tag">Kinematic Modeling</span>
                                        </div>
                                    </div>
                                    <div class="lg:w-1/3 pt-4">
                                        <div class="space-y-4">
                                            <div class="p-4 bg-slate-900/50 rounded-xl border border-slate-800">
                                                <p class="text-[10px] font-black text-slate-500 uppercase tracking-widest mb-3">The demo is a minimal working demonstration of the algorithms</p>
                                            </div>
                                            <a href="#" class="block w-full text-center py-3 bg-slate-100 hover:bg-white text-slate-900 rounded-xl font-bold text-xs transition-all flex items-center justify-center gap-2">
                                                <i data-lucide="github" class="w-4 h-4"></i> ACCESS REPOSITORY
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- PROJECT: REAL-TIME URBAN RESERVOIR MONITORING -->
                       <div class="glass-card rounded-2xl overflow-hidden flex flex-col">
                            <div class="w-full bg-slate-900 p-8 flex items-center justify-center min-h-[300px] border-b border-slate-800">
                                <i data-lucide="droplets" class="text-blue-500 w-24 h-24"></i>
                            </div>
                            <div class="w-full p-8 flex flex-col justify-between">
                                <div>
                                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start mb-4">
                                        <div>
                                            <h3 class="text-xl font-bold text-slate-100">Real-Time Urban Reservoir Monitoring System</h3>
                                        </div>
                                    </div>
                                    <p class="text-slate-400 text-sm mb-6 leading-relaxed">
                                        Designed and implemented an end-to-end hardware–software system for real-time environmental and hydrological monitoring as part of a public welfare initiative for Beijing. 
                                        Developed a Raspberry Pi–based sensor platform integrating temperature, humidity, air pressure, wind speed, and ultrasonic sensors for high-precision water-level data acquisition.
                                        Implemented low-latency embedded firmware in C/C++ to enable reliable data transmission to a Python-based backend, supporting real-time visualization and automated alerting.
                                    </p>
                                    <div class="flex flex-wrap gap-2">
                                        <span class="skill-tag">Embedded C/C++</span>
                                        <span class="skill-tag">Raspberry Pi</span>
                                        <span class="skill-tag">Python</span>
                                        <span class="skill-tag">Communication Protocols: I2C / SPI / UART</span>
                                        <span class="skill-tag">System Visualization</span>
                                    </div>
                                </div>
                                <div class="pt-6 border-t border-slate-800">
                                    <a href="https://github.com/xiaozh26/Urban-Water-Monitoring-RPi" target="_blank" class="block w-full text-center py-3 bg-slate-100 hover:bg-white text-slate-900 rounded-xl font-bold text-xs transition-all flex items-center justify-center gap-2">
                                        <i data-lucide="github" class="w-4 h-4"></i> ACCESS REPOSITORY
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- PROJECT 3: SUSTAINABLE DATA CENTER THERMAL MANAGEMENT -->
                        <div class="glass-card rounded-2xl overflow-hidden flex flex-col">
                            <!-- Visual Demo: Heat Recovery Dashboard -->
                            <div class="w-full bg-slate-900 relative min-h-[350px] border-b border-slate-800 p-8 flex items-center justify-center">
                                <svg width="600" height="350" viewBox="0 0 600 350" class="w-full h-full max-w-[600px]">
                                    <!-- Styles -->
                                    <defs>
                                        <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
                                            <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#1e293b" stroke-width="1"/>
                                        </pattern>
                                    </defs>
                                    
                                    <!-- Server Tank (Oil) -->
                                    <rect x="40" y="180" width="100" height="140" rx="4" fill="#1e293b" stroke="#475569" stroke-width="2"/>
                                    <text x="90" y="250" fill="#94a3b8" font-size="12" text-anchor="middle">OIL BATH</text>
                                    <text x="90" y="270" fill="#cbd5e1" font-size="10" text-anchor="middle">SERVERS</text>
                                    
                                    <!-- Radiator -->
                                    <rect x="220" y="20" width="100" height="60" rx="4" fill="#1e293b" stroke="#475569" stroke-width="2"/>
                                    <path d="M220 20 L320 80 M320 20 L220 80" stroke="#334155" stroke-width="1" opacity="0.3"/>
                                    <text x="270" y="55" fill="#94a3b8" font-size="12" text-anchor="middle">RADIATOR</text>
                                    
                                    <!-- Water Tank -->
                                    <rect x="440" y="100" width="120" height="220" rx="8" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
                                    <text x="500" y="200" fill="#3b82f6" font-size="14" text-anchor="middle" font-weight="bold">WATER TANK</text>
                                    
                                    <!-- Pipes (Static Background) -->
                                    <path d="M90 180 V 160 H 250" stroke="#334155" stroke-width="4" fill="none"/> 
                                    <path d="M250 160 V 80" stroke="#334155" stroke-width="4" fill="none"/>
                                    <path d="M250 160 H 440" stroke="#334155" stroke-width="4" fill="none"/>
                                    <path d="M290 80 V 160" stroke="#334155" stroke-width="4" fill="none"/>
                                    <path d="M440 280 H 290 V 160" stroke="#334155" stroke-width="4" fill="none"/>
                                    <path d="M290 160 H 140 V 180" stroke="#334155" stroke-width="4" fill="none"/>

                                    <!-- Active Flow Paths (Animated via Class) -->
                                    <path id="pipe-server-out" d="M90 180 V 160 H 250" stroke="#ef4444" stroke-width="2" class="pipe-flow" fill="none" opacity="0.8"/>
                                    <path id="pipe-rad-in" d="M250 160 V 80" stroke="#ef4444" stroke-width="2" class="pipe-flow hidden-flow" fill="none"/>
                                    <path id="pipe-rad-out" d="M290 80 V 160" stroke="#3b82f6" stroke-width="2" class="pipe-flow hidden-flow" fill="none"/>
                                    <path id="pipe-tank-in" d="M250 160 H 440" stroke="#ef4444" stroke-width="2" class="pipe-flow" fill="none"/>
                                    <path id="pipe-tank-coil" d="M440 160 Q 500 160 500 220 T 440 280" stroke="#ef4444" stroke-width="2" class="pipe-flow" fill="none"/>
                                    <path id="pipe-tank-out" d="M440 280 H 290" stroke="#3b82f6" stroke-width="2" class="pipe-flow" fill="none"/>
                                    <path id="pipe-return" d="M290 160 H 130 V 180" stroke="#3b82f6" stroke-width="2" class="pipe-flow" fill="none"/>

                                    <!-- Sensors & Labels -->
                                    <g transform="translate(450, 120)">
                                        <rect width="40" height="20" rx="2" fill="#0f172a" stroke="#64748b"/>
                                        <text x="20" y="14" fill="#ef4444" font-size="10" text-anchor="middle" id="val-t1">42°C</text>
                                        <text x="50" y="14" fill="#64748b" font-size="8">T1 (Water)</text>
                                    </g>
                                    
                                    <g transform="translate(50, 140)">
                                        <rect width="40" height="20" rx="2" fill="#0f172a" stroke="#64748b"/>
                                        <text x="20" y="14" fill="#fbbf24" font-size="10" text-anchor="middle" id="val-t3">65°C</text>
                                        <text x="50" y="14" fill="#64748b" font-size="8">T3 (Server)</text>
                                    </g>

                                    <!-- Valves -->
                                    <circle cx="250" cy="160" r="6" fill="#cbd5e1" stroke="#475569"/>
                                    <text x="250" y="150" fill="#94a3b8" font-size="8" text-anchor="middle">V1</text>
                                    
                                    <circle cx="290" cy="160" r="6" fill="#cbd5e1" stroke="#475569"/>
                                    <text x="290" y="150" fill="#94a3b8" font-size="8" text-anchor="middle">V2</text>
                                    
                                    <!-- Status Box -->
                                    <g transform="translate(20, 20)">
                                        <rect width="160" height="60" rx="4" fill="#1e293b" stroke="#3b82f6" stroke-opacity="0.5"/>
                                        <text x="10" y="20" fill="#94a3b8" font-size="10">MODE:</text>
                                        <text x="50" y="20" font-size="10" font-weight="bold" id="sys-mode" fill="#34d399">HEAT RECOVERY</text>
                                        <text x="10" y="40" fill="#94a3b8" font-size="10">PUMP:</text>
                                        <text x="50" y="40" fill="#3b82f6" font-size="10" font-weight="bold">ACTIVE</text>
                                    </g>
                                </svg>
                            </div>

                            <div class="w-full p-8 flex flex-col justify-between">
                                <div>
                                    <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start mb-4">
                                        <div>
                                            <h3 class="text-xl font-bold text-slate-100">Sustainable Data Center Thermal Management System</h3>
                                            <p class="text-blue-400 font-medium mono text-xs uppercase mt-1">Independent Research Initiative</p>
                                        </div>
                                    </div>
                                    <p class="text-slate-400 text-sm mb-6 leading-relaxed">
                                        Conducted independent research on sustainable data center infrastructure with a focus on thermal management. Motivated by the energy costs of server cooling, I designed a dual-purpose heat recovery system that repurposes waste heat from servers to provide domestic hot water, simultaneously reducing server cooling costs and household energy demand. I built a functional hardware prototype using heat exchangers, sensors, and microcontrollers, and developed a dynamic thermal management algorithm to optimize heat transfer efficiency under varying workloads and water usage patterns.
                                    </p>
                                    <div class="flex flex-wrap gap-2">
                                        <span class="skill-tag">Thermodynamics</span>
                                        <span class="skill-tag">Sensors Integration</span>
                                        <span class="skill-tag">Microcontrollers</span>
                                        <span class="skill-tag">Control Algorithms</span>
                                        <span class="skill-tag">Sustainable Energy</span>
                                        <span class="skill-tag">Hardware Prototyping</span>
                                    </div>
                                </div>
                                <div class="pt-6 border-t border-slate-800">
                                    <a href="#" class="block w-full text-center py-3 bg-slate-100 hover:bg-white text-slate-900 rounded-xl font-bold text-xs transition-all flex items-center justify-center gap-2">
                                        <i data-lucide="file-text" class="w-4 h-4"></i> VIEW RESEARCH PAPER
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- COURSEWORK VIEW -->
                <section id="coursework" class="view-section">
                    <h2 class="text-2xl font-bold text-slate-100 mb-6">Relevant Coursework</h2>
                    
                    <div class="mb-10 flex flex-col md:flex-row items-center gap-6 p-6 glass-card rounded-2xl border-blue-500/30">
                        <!-- GPA Section (Left) -->
                        <div class="flex items-center gap-6 w-full md:w-auto">
                            <div class="w-16 h-16 rounded-full bg-blue-500/10 flex items-center justify-center text-blue-400 flex-shrink-0">
                                <i data-lucide="graduation-cap" class="w-8 h-8"></i>
                            </div>
                            <div>
                                <p class="text-xs font-bold text-slate-500 uppercase tracking-widest mb-1">Cumulative GPA</p>
                                <div class="flex items-baseline gap-2">
                                    <span class="text-4xl font-bold text-slate-100">3.96</span>
                                    <span class="text-lg text-slate-500 font-medium">/ 4.0</span>
                                </div>
                            </div>
                        </div>

                        <!-- Term Tracker (Right) -->
                        <div class="md:ml-auto w-full md:w-auto border-t md:border-t-0 md:border-l border-slate-800 pt-4 md:pt-0 md:pl-6">
                            <div id="term-list" class="grid grid-cols-2 sm:grid-cols-3 gap-y-2 gap-x-4">
                                <!-- Term items injected via JS -->
                            </div>
                        </div>
                    </div>

                    <div class="space-y-16">
                        <!-- COMPLETED -->
                        <div>
                            <div class="flex items-center gap-3 mb-8">
                                <div class="w-10 h-10 rounded-full bg-blue-500/20 text-blue-400 flex items-center justify-center"><i data-lucide="check-circle" class="w-5 h-5"></i></div>
                                <h3 class="text-xl font-bold text-slate-100 tracking-tight">Completed Courses</h3>
                            </div>
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                                <!-- EECS Column -->
                                <div class="space-y-6">
                                    <div class="text-[11px] font-black text-blue-400 uppercase tracking-[0.2em]">EECS</div>
                                    <div class="space-y-4">
                                        <p class="text-[10px] text-slate-500 uppercase font-black">Lower Division</p>
                                        <div class="space-y-2">
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">CS 61A</p><p class="text-[11px] text-slate-500">Structure and Interpretation of Computer Programs</p></div>
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">CS 61B</p><p class="text-[11px] text-slate-500">Data Structures</p></div>
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">CS 70</p><p class="text-[11px] text-slate-500">Discrete Mathematics and Probability Theory</p></div>
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">EECS 16A</p><p class="text-[11px] text-slate-500">Foundations of Signals, Dynamical Systems, and Information Processing</p></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="space-y-6">
                                    <div class="text-[11px] font-black text-emerald-400 uppercase tracking-[0.2em]">Economics (Quantitative)</div>
                                    <div class="space-y-4">
                                        <p class="text-[10px] text-slate-500 uppercase font-black">Lower Division</p>
                                        <div class="space-y-2">
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">ECON 1</p><p class="text-[11px] text-slate-500">Introduction to Economics</p></div>
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">STAT 20</p><p class="text-[11px] text-slate-500">Introduction to Probability and Statistics</p></div>
                                        </div>
                                        <p class="text-[10px] text-slate-500 uppercase font-black">Upper Division</p>
                                        <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">ECON 101B</p><p class="text-[11px] text-slate-500">Macroeconomics (Math Intensive)</p></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- IN PROGRESS -->
                        <div>
                            <div class="flex items-center gap-3 mb-8">
                                <div class="w-10 h-10 rounded-full bg-orange-500/20 text-orange-400 flex items-center justify-center"><i data-lucide="loader" class="w-5 h-5"></i></div>
                                <h3 class="text-xl font-bold text-slate-100 tracking-tight">Courses in Progress</h3>
                            </div>
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                                <div class="space-y-6">
                                    <div class="text-[11px] font-black text-blue-400 uppercase tracking-[0.2em]">EECS</div>
                                    <div class="space-y-4">
                                        <p class="text-[10px] text-slate-500 uppercase font-black">Lower Division</p>
                                        <div class="space-y-2">
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">EECS 16B</p><p class="text-[11px] text-slate-500">Introduction to Circuits and Devices</p></div>
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">ENGIN 29</p><p class="text-[11px] text-slate-500">Manufacturing and Design Communication</p></div>
                                            <div class="px-4 py-3 bg-slate-900/40 border border-slate-800 rounded-xl"><p class="text-xs font-bold">ENGIN 26</p><p class="text-[11px] text-slate-500">Three-Dimensional Modeling for Design</p></div>
                                        </div>
                                        <p class="text-[10px] text-slate-500 uppercase font-black">Upper Division</p>
                                        <div class="px-4 py-3 bg-slate-900/40 border border-blue-500/30 rounded-xl"><p class="text-xs font-bold">EE 120</p><p class="text-[11px] text-slate-500 italic">Signals and Systems</p></div>
                                    </div>
                                </div>
                                <div class="space-y-6">
                                    <div class="text-[11px] font-black text-emerald-400 uppercase tracking-[0.2em]">Economics (Quantitative)</div>
                                    <div class="space-y-4">
                                        <p class="text-[10px] text-slate-500 uppercase font-black">Upper Division</p>
                                        <div class="space-y-2">
                                            <div class="px-4 py-3 bg-slate-900/40 border border-emerald-500/30 rounded-xl"><p class="text-xs font-bold">PUBPOL 141</p><p class="text-[11px] text-slate-500 italic">Behavioral Economics for Public Policy</p></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

            </main>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const hasWorkExperience = true; 
        const hasResearchExperience = false;

        // --- TERM TRACKER LOGIC ---
        function renderTerms() {
            const terms = [
                { name: "Fall 2025", start: new Date("2025-08-01"), end: new Date("2025-12-31") },
                { name: "Spring 2026", start: new Date("2026-01-01"), end: new Date("2026-05-31") },
                { name: "Fall 2026", start: new Date("2026-08-01"), end: new Date("2026-12-31") },
                { name: "Spring 2027", start: new Date("2027-01-01"), end: new Date("2027-05-31") },
                { name: "Fall 2027", start: new Date("2027-08-01"), end: new Date("2027-12-31") },
                { name: "Spring 2028", start: new Date("2028-01-01"), end: new Date("2028-05-31") }
            ];

            const now = new Date();
            const container = document.getElementById('term-list');
            if(!container) return;

            container.innerHTML = terms.map(term => {
                let styleClass = "text-slate-500"; // Future/Default
                
                if (now > term.end) {
                    // Past (Dimmed)
                    styleClass = "text-slate-200 opacity-40 decoration-slate-800"; 
                } else if (now >= term.start && now <= term.end) {
                    // Current (Highlighted)
                    styleClass = "text-blue-400 font-bold bg-blue-500/10 px-2 rounded border border-blue-500/20 shadow-[0_0_15px_-3px_rgba(59,130,246,0.3)]";
                } else {
                    // Future
                    styleClass = "text-slate-400 opacity-80";
                }

                return `<div class="text-[10px] mono uppercase tracking-wide ${styleClass} py-1 text-center transition-all flex items-center justify-center whitespace-nowrap">${term.name}</div>`;
            }).join('');
        }

        // --- 3D VESSEL SIMULATION ---
        let scene, camera, renderer, raycaster, mouse, vessel, waterPlane, waypointMarker;
        let obstacles = [], rays = [], sensorRaycaster, ducks = [];
        let state = "IDLE";
        let boatPose = { x: -8, z: 8, th: 0, v: 0 };
        let target = { x: -8, z: 8 };

        function initVesselDemo() {
            const container = document.getElementById('vessel-canvas-container');
            if (!container) return;
            const rect = container.getBoundingClientRect();

            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(40, rect.width / rect.height, 0.1, 1000);
            camera.position.set(0, 18, 22);
            camera.lookAt(0, 0, 0);

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(rect.width, rect.height);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            raycaster = new THREE.Raycaster();
            sensorRaycaster = new THREE.Raycaster();
            mouse = new THREE.Vector2();

            // Lighting
            scene.add(new THREE.AmbientLight(0xffffff, 0.4));
            const sun = new THREE.DirectionalLight(0xffffff, 0.8);
            sun.position.set(10, 20, 10);
            scene.add(sun);

            // Water Plane (Click Detector)
            const waterGeo = new THREE.PlaneGeometry(30, 30);
            const waterMat = new THREE.MeshPhongMaterial({ color: 0x0f172a, transparent: true, opacity: 0.8 });
            waterPlane = new THREE.Mesh(waterGeo, waterMat);
            waterPlane.rotation.x = -Math.PI / 2;
            scene.add(waterPlane);

            const grid = new THREE.GridHelper(30, 30, 0x1e293b, 0x1e293b);
            scene.add(grid);

            // Waypoint Marker
            const wayGeo = new THREE.RingGeometry(0.4, 0.5, 32);
            const wayMat = new THREE.MeshBasicMaterial({color: 0x3b82f6, side: THREE.DoubleSide});
            waypointMarker = new THREE.Mesh(wayGeo, wayMat);
            waypointMarker.rotation.x = -Math.PI/2;
            waypointMarker.visible = false;
            scene.add(waypointMarker);

            // Vessel Model
            const boatGroup = new THREE.Group();
            const hullGeo = new THREE.BoxGeometry(1.2, 0.4, 2.5);
            const hullMat = new THREE.MeshPhongMaterial({ color: 0xf1f5f9 });
            const hull = new THREE.Mesh(hullGeo, hullMat);
            boatGroup.add(hull);

            const cabin = new THREE.Mesh(new THREE.BoxGeometry(0.8, 0.4, 0.8), new THREE.MeshPhongMaterial({color: 0x3b82f6}));
            cabin.position.set(0, 0.4, 0);
            boatGroup.add(cabin);

            vessel = boatGroup;
            scene.add(vessel);

            // Confidence Radius
            const conf = new THREE.Mesh(new THREE.RingGeometry(1.2, 1.3, 32), new THREE.MeshBasicMaterial({color: 0x3b82f6, transparent: true, opacity: 0.2, side: THREE.DoubleSide}));
            conf.rotation.x = -Math.PI/2;
            vessel.add(conf);

            // Stationary Obstacles (Rocks)
            const rockMat = new THREE.MeshPhongMaterial({color: 0x64748b, flatShading: true});
            const positions = [[5, 5], [-5, -5], [8, -2], [-2, 4], [0, -8], [3, -4], [-6, 2]];
            
            positions.forEach(pos => {
                const geo = new THREE.IcosahedronGeometry(0.6 + Math.random()*0.4, 0);
                const rock = new THREE.Mesh(geo, rockMat);
                rock.position.set(pos[0], 0.3, pos[1]);
                rock.rotation.set(Math.random()*Math.PI, Math.random()*Math.PI, Math.random()*Math.PI);
                scene.add(rock);
                obstacles.push(rock);
            });

            // Moving Obstacles (Ducks)
            const duckGroup = new THREE.Group();
            const bodyGeo = new THREE.SphereGeometry(0.4, 8, 8);
            const bodyMat = new THREE.MeshPhongMaterial({color: 0xfacc15}); // Yellow
            const body = new THREE.Mesh(bodyGeo, bodyMat);
            
            const headGeo = new THREE.SphereGeometry(0.25, 8, 8);
            const head = new THREE.Mesh(headGeo, bodyMat);
            head.position.set(0.3, 0.3, 0);
            
            const beakGeo = new THREE.ConeGeometry(0.1, 0.2, 8);
            const beakMat = new THREE.MeshPhongMaterial({color: 0xf97316}); // Orange
            const beak = new THREE.Mesh(beakGeo, beakMat);
            beak.rotation.z = -Math.PI/2;
            beak.position.set(0.5, 0.3, 0);

            duckGroup.add(body, head, beak);
            
            // Create a few ducks
            for(let i=0; i<3; i++) {
                const duck = duckGroup.clone();
                duck.position.set((Math.random()-0.5)*15, 0.3, (Math.random()-0.5)*15);
                duck.userData = { 
                    velocity: new THREE.Vector3((Math.random()-0.5)*0.05, 0, (Math.random()-0.5)*0.05),
                    phase: Math.random() * Math.PI * 2 
                };
                scene.add(duck);
                obstacles.push(duck); // Add to obstacles for avoidance/sensing
                ducks.push(duck); // Keep track for animation
            }

            // Visual Rays (Always Visible)
            for(let i=0; i<4; i++) {
                // Line geometry for ray visual (length 1, will scale)
                const rayGeo = new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(0,0,0), new THREE.Vector3(0,0,1)]);
                const rayMat = new THREE.LineBasicMaterial({color: 0xef4444, transparent: true, opacity: 0.4});
                const ray = new THREE.Line(rayGeo, rayMat);
                vessel.add(ray);
                rays.push(ray);
            }

            container.addEventListener('click', onWaterClick);
            animate();
        }

        function onWaterClick(event) {
            // Ensure clicks on UI buttons don't trigger movement
            if (event.target !== renderer.domElement) return;

            const container = document.getElementById('vessel-canvas-container');
            const rect = container.getBoundingClientRect();
            mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;

            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObject(waterPlane);

            if (intersects.length > 0) {
                target.x = intersects[0].point.x;
                target.z = intersects[0].point.z;
                
                waypointMarker.position.set(target.x, 0.05, target.z);
                waypointMarker.visible = true;
                
                state = "MISSION";
                document.getElementById('tel-stat').textContent = "MISSION";
                document.getElementById('tel-stat').className = "text-blue-400";
            }
        }

        function animate() {
            requestAnimationFrame(animate);
            
            // Update Ducks
            ducks.forEach(duck => {
                duck.position.add(duck.userData.velocity);
                // Simple bounds check/bounce
                if(Math.abs(duck.position.x) > 14) duck.userData.velocity.x *= -1;
                if(Math.abs(duck.position.z) > 14) duck.userData.velocity.z *= -1;
                
                // Bobbing
                duck.position.y = 0.3 + Math.sin(Date.now() * 0.005 + duck.userData.phase) * 0.05;
                
                // Face direction
                const angle = Math.atan2(duck.userData.velocity.z, duck.userData.velocity.x); 
                duck.rotation.y = -angle; 
            });

            if (state !== "IDLE") {
                // POTENTIAL FIELD NAVIGATION
                let attractiveX = target.x - boatPose.x;
                let attractiveZ = target.z - boatPose.z;
                let distToTarget = Math.sqrt(attractiveX**2 + attractiveZ**2);
                
                if (distToTarget > 0) {
                    attractiveX /= distToTarget;
                    attractiveZ /= distToTarget;
                }

                let repulsiveX = 0, repulsiveZ = 0;
                obstacles.forEach(obs => {
                    let dx = boatPose.x - obs.position.x;
                    let dz = boatPose.z - obs.position.z;
                    let dist = Math.sqrt(dx*dx + dz*dz);
                    if (dist < 3) {
                        let force = (1.0 / dist) - (1.0 / 3.0);
                        repulsiveX += (dx / dist) * force * 5;
                        repulsiveZ += (dz / dist) * force * 5;
                    }
                });

                let resX = attractiveX + repulsiveX;
                let resZ = attractiveZ + repulsiveZ;

                if (distToTarget > 0.3) {
                    const desiredHeading = Math.atan2(resX, resZ);
                    let angleDiff = desiredHeading - boatPose.th;
                    while (angleDiff < -Math.PI) angleDiff += Math.PI * 2;
                    while (angleDiff > Math.PI) angleDiff -= Math.PI * 2;

                    boatPose.th += angleDiff * 0.08;
                    boatPose.v = 0.07;
                } else {
                    boatPose.v = 0;
                    if (state === "RTH") {
                        state = "IDLE";
                        document.getElementById('tel-stat').textContent = "IDLE";
                        document.getElementById('tel-stat').className = "text-emerald-400";
                        waypointMarker.visible = false;
                    }
                }

                boatPose.x += Math.sin(boatPose.th) * boatPose.v;
                boatPose.z += Math.cos(boatPose.th) * boatPose.v;
            }

            vessel.position.set(boatPose.x, 0.25, boatPose.z);
            vessel.rotation.y = boatPose.th;

            // UI & Sensor Raycasting Updates
            document.getElementById('tel-x').textContent = boatPose.x.toFixed(2);
            document.getElementById('tel-y').textContent = boatPose.z.toFixed(2);
            document.getElementById('tel-th').textContent = (boatPose.th * 180 / Math.PI).toFixed(1) + "°";

            // Raycasting logic
            const sensorOffsets = [0, -Math.PI/2, Math.PI, Math.PI/2]; // Front, Right, Back, Left relative to heading
            const maxRange = 5; // meters

            sensorOffsets.forEach((offset, i) => {
                const angle = boatPose.th + offset;
                const dir = new THREE.Vector3(Math.sin(angle), 0, Math.cos(angle)).normalize();
                const origin = new THREE.Vector3(boatPose.x, 0.5, boatPose.z);
                
                sensorRaycaster.set(origin, dir);
                const intersects = sensorRaycaster.intersectObjects(obstacles);
                
                let dist = maxRange * 1000; // mm
                if (intersects.length > 0) {
                    const d = intersects[0].distance;
                    if(d < maxRange) dist = Math.floor(d * 1000);
                }
                
                // Update UI Text
                document.getElementById(`s${i+1}-val`).textContent = dist;

                // Update Visual Ray
                const rayLine = rays[i];
                rayLine.material.opacity = 0.4; // Always visible
                
                // Align ray line to sensor direction locally
                if(i===0) rayLine.rotation.set(0,0,0);
                if(i===1) rayLine.rotation.set(0, -Math.PI/2, 0);
                if(i===2) rayLine.rotation.set(0, Math.PI, 0);
                if(i===3) rayLine.rotation.set(0, Math.PI/2, 0);

                const scaleLen = (dist / 1000) / 1; // Base length is 1 unit
                rayLine.scale.z = dist/1000; 
                rayLine.position.y = 0.1;
            });

            renderer.render(scene, camera);
        }

        function triggerRTH() {
            state = "RTH";
            target = { x: -8, z: 8 };
            waypointMarker.position.set(target.x, 0.05, target.z);
            waypointMarker.visible = true;
            document.getElementById('tel-stat').textContent = "RTH";
            document.getElementById('tel-stat').className = "text-orange-400";
        }

        // --- THERMAL DEMO LOGIC ---
        let thState = {
            tServer: 60,
            tWater: 30,
            mode: 'RECOVERY'
        };

        function updateThermalDemo() {
            // Physics Constants
            const HEAT_RATE = 0.05;
            const WATER_HEAT_RATE = 0.03;
            const WATER_COOL_RATE = 0.01;
            const TARGET_COOL_TEMP = 65;
            const COOLING_STRENGTH = 0.1;

            // Logic
            if (thState.mode === 'RECOVERY') {
                // Server heats up
                thState.tServer += HEAT_RATE;
                // Water heats up (absorbing server heat)
                thState.tWater += WATER_HEAT_RATE;

                // Trigger switch to Cooling if Water gets too hot
                if (thState.tWater >= 45) {
                    thState.mode = 'COOLING';
                }
            } else {
                // COOLING (Radiator Active)
                // Server moves towards target temp (65)
                // If it's hotter than 65, it cools down fast.
                if (thState.tServer > TARGET_COOL_TEMP) {
                    thState.tServer -= COOLING_STRENGTH;
                } else {
                    // Small fluctuation around target
                    thState.tServer += (Math.random() - 0.5) * 0.1; 
                }

                // Water cools down slowly
                thState.tWater -= WATER_COOL_RATE;

                // Trigger switch back to Recovery if Water is cool enough
                if (thState.tWater <= 35) { // Hysteresis
                    thState.mode = 'RECOVERY';
                }
            }

            // Update DOM
            document.getElementById('val-t3').textContent = thState.tServer.toFixed(1) + '°C';
            document.getElementById('val-t1').textContent = thState.tWater.toFixed(1) + '°C';
            
            const modeText = document.getElementById('sys-mode');
            const pipeRadIn = document.getElementById('pipe-rad-in');
            const pipeRadOut = document.getElementById('pipe-rad-out');
            const pipeTankIn = document.getElementById('pipe-tank-in');
            const pipeTankCoil = document.getElementById('pipe-tank-coil');
            const pipeTankOut = document.getElementById('pipe-tank-out');

            if (thState.mode === 'RECOVERY') {
                modeText.textContent = "HEAT RECOVERY";
                modeText.style.fill = "#34d399"; 
                
                // Show Tank path
                pipeTankIn.classList.remove('hidden-flow');
                pipeTankCoil.classList.remove('hidden-flow');
                pipeTankOut.classList.remove('hidden-flow');
                // Hide Radiator path
                pipeRadIn.classList.add('hidden-flow');
                pipeRadOut.classList.add('hidden-flow');
            } else {
                modeText.textContent = "RADIATOR COOLING";
                modeText.style.fill = "#60a5fa"; 
                
                // Hide Tank path
                pipeTankIn.classList.add('hidden-flow');
                pipeTankCoil.classList.add('hidden-flow');
                pipeTankOut.classList.add('hidden-flow');
                // Show Radiator path
                pipeRadIn.classList.remove('hidden-flow');
                pipeRadOut.classList.remove('hidden-flow');
            }

            requestAnimationFrame(updateThermalDemo);
        }

        // --- RENDER LOGIC ---
        function initializeContent() {
            const expContainer = document.getElementById('experience-container');
            const resContainer = document.getElementById('research-container');

            if (hasWorkExperience) {
                expContainer.innerHTML = `
                    <div class="glass-card p-6 rounded-2xl flex gap-6">
                        <div class="hidden sm:block w-14 h-14 rounded-lg bg-white p-2 flex-shrink-0 flex items-center justify-center">
                            <img src="hkn.png" alt="HKN Logo" class="w-full h-full object-contain" onerror="this.src='https://hkn.org/wp-content/uploads/2019/03/HKN-Seal-Color.png'">
                        </div>
                        <div class="flex-grow">
                            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-start mb-2">
                                <div>
                                    <h3 class="text-lg font-bold text-slate-100 leading-tight">Service Officer</h3>
                                    <p class="text-blue-400 font-medium">Eta Kappa Nu (HKN), UC Berkeley</p>
                                </div>
                                <span class="text-sm mono text-slate-500 mt-1 sm:mt-0">September 2025 — Present</span>
                            </div>
                            <div class="space-y-2 text-slate-400 text-sm mb-4 leading-relaxed">
                                <p>• Organize, coordinate, and run community outreach and service events, promoting EECS education and engagement within the local student community.</p>
                                <p>• Develop and coordinate electrical engineering and computer science related workshops for local high school students.</p>
                                <p>• Lead and run weekly tutoring sessions for EECS coursework at UC Berkeley, supporting undergraduate students in core computer science and electrical engineering classes.</p>
                            </div>
                            <div class="flex flex-wrap gap-2">
                                <span class="skill-tag">Outreach</span>
                                <span class="skill-tag">Tutoring</span>
                                <span class="skill-tag">EECS Education</span>
                                <span class="skill-tag">Leadership</span>
                            </div>
                        </div>
                    </div>`;
            } else {
                expContainer.innerHTML = `<div class="glass-card p-12 rounded-2xl text-center border-dashed border-slate-700"><p class="text-slate-500 mono text-sm tracking-widest uppercase">Stay Tuned — Professional roles in progress</p></div>`;
            }

            if (hasResearchExperience) {
                resContainer.innerHTML = `<!-- Research placeholder -->`;
            } else {
                resContainer.innerHTML = `<div class="glass-card p-12 rounded-2xl text-center border-dashed border-slate-700"><p class="text-slate-500 mono text-sm tracking-widest uppercase">Stay Tuned — Research initiatives coming soon</p></div>`;
            }
            
            lucide.createIcons();
            setTimeout(initVesselDemo, 100);
            updateThermalDemo(); // Start thermal demo loop
            renderTerms(); // Initialize term tracker
        }

        function showSection(sectionId) {
            document.querySelectorAll('.view-section').forEach(section => section.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            if (window.innerWidth < 1024) { window.scrollTo({ top: 0, behavior: 'smooth' }); }
            
            if(sectionId === 'projects' && renderer) {
                const container = document.getElementById('vessel-canvas-container');
                const rect = container.getBoundingClientRect();
                renderer.setSize(rect.width, rect.height);
                camera.aspect = rect.width / rect.height;
                camera.updateProjectionMatrix();
            }
        }

        window.onload = initializeContent;
    </script>
</body>
</html>